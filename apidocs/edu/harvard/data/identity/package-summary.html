<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<!-- NewPage -->
<html lang="en">
<head>
<!-- Generated by javadoc (1.8.0_45) on Fri Aug 26 13:46:56 EDT 2016 -->
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>edu.harvard.data.identity (data_client 1.0.0 API)</title>
<meta name="date" content="2016-08-26">
<link rel="stylesheet" type="text/css" href="../../../../stylesheet.css" title="Style">
<script type="text/javascript" src="../../../../script.js"></script>
</head>
<body>
<script type="text/javascript"><!--
    try {
        if (location.href.indexOf('is-external=true') == -1) {
            parent.document.title="edu.harvard.data.identity (data_client 1.0.0 API)";
        }
    }
    catch(err) {
    }
//-->
</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
<!-- ========= START OF TOP NAVBAR ======= -->
<div class="topNav"><a name="navbar.top">
<!--   -->
</a>
<div class="skipNav"><a href="#skip.navbar.top" title="Skip navigation links">Skip navigation links</a></div>
<a name="navbar.top.firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../../overview-summary.html">Overview</a></li>
<li class="navBarCell1Rev">Package</li>
<li>Class</li>
<li><a href="package-use.html">Use</a></li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../../index-all.html">Index</a></li>
<li><a href="../../../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList">
<li><a href="../../../../edu/harvard/data/generator/package-summary.html">Prev&nbsp;Package</a></li>
<li><a href="../../../../edu/harvard/data/io/package-summary.html">Next&nbsp;Package</a></li>
</ul>
<ul class="navList">
<li><a href="../../../../index.html?edu/harvard/data/identity/package-summary.html" target="_top">Frames</a></li>
<li><a href="package-summary.html" target="_top">No&nbsp;Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_top">
<li><a href="../../../../allclasses-noframe.html">All&nbsp;Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_top");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<a name="skip.navbar.top">
<!--   -->
</a></div>
<!-- ========= END OF TOP NAVBAR ========= -->
<div class="header">
<h1 title="Package" class="title">Package&nbsp;edu.harvard.data.identity</h1>
<div class="docSummary">
<div class="block">This package contains the majority of the code needed to manage user
 identities across data sets.</div>
</div>
<p>See:&nbsp;<a href="#package.description">Description</a></p>
</div>
<div class="contentContainer">
<ul class="blockList">
<li class="blockList">
<table class="typeSummary" border="0" cellpadding="3" cellspacing="0" summary="Interface Summary table, listing interfaces, and an explanation">
<caption><span>Interface Summary</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colFirst" scope="col">Interface</th>
<th class="colLast" scope="col">Description</th>
</tr>
<tbody>
<tr class="altColor">
<td class="colFirst"><a href="../../../../edu/harvard/data/identity/TableIdentityMapper.html" title="interface in edu.harvard.data.identity">TableIdentityMapper</a>&lt;T&gt;</td>
<td class="colLast">
<div class="block">Interface to provide table-specific functionality for the Hadoop identity map
 job.</div>
</td>
</tr>
</tbody>
</table>
</li>
<li class="blockList">
<table class="typeSummary" border="0" cellpadding="3" cellspacing="0" summary="Class Summary table, listing classes, and an explanation">
<caption><span>Class Summary</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colFirst" scope="col">Class</th>
<th class="colLast" scope="col">Description</th>
</tr>
<tbody>
<tr class="altColor">
<td class="colFirst"><a href="../../../../edu/harvard/data/identity/HadoopIdentityKey.html" title="class in edu.harvard.data.identity">HadoopIdentityKey</a></td>
<td class="colLast">
<div class="block">Wrapper class to allow Hadoop to serialize an <a href="../../../../edu/harvard/data/identity/IdentityMap.html" title="class in edu.harvard.data.identity"><code>IdentityMap</code></a>.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><a href="../../../../edu/harvard/data/identity/HuidEppnLookup.html" title="class in edu.harvard.data.identity">HuidEppnLookup</a></td>
<td class="colLast">&nbsp;</td>
</tr>
<tr class="altColor">
<td class="colFirst"><a href="../../../../edu/harvard/data/identity/IdentityMap.html" title="class in edu.harvard.data.identity">IdentityMap</a></td>
<td class="colLast">
<div class="block">This class represents an entry in the environment-scoped
 <code>identity_map</code> table.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><a href="../../../../edu/harvard/data/identity/IdentityMapHadoopJob.html" title="class in edu.harvard.data.identity">IdentityMapHadoopJob</a></td>
<td class="colLast">&nbsp;</td>
</tr>
<tr class="altColor">
<td class="colFirst"><a href="../../../../edu/harvard/data/identity/IdentityMapper.html" title="class in edu.harvard.data.identity">IdentityMapper</a>&lt;T&gt;</td>
<td class="colLast">
<div class="block">Helper class that implements the common logic for the various mapper classes
 used during the first identity Hadoop job.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><a href="../../../../edu/harvard/data/identity/IdentityReducer.html" title="class in edu.harvard.data.identity">IdentityReducer</a>&lt;T&gt;</td>
<td class="colLast">
<div class="block">Helper class that implements the actual logic for the reduce phase during the
 identity generation job.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><a href="../../../../edu/harvard/data/identity/IdentitySchemaTransformer.html" title="class in edu.harvard.data.identity">IdentitySchemaTransformer</a></td>
<td class="colLast">
<div class="block">This class modifies a <a href="../../../../edu/harvard/data/schema/DataSchema.html" title="interface in edu.harvard.data.schema"><code>DataSchema</code></a> according to a specification of
 identifying fields in the various tables of the data set.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><a href="../../../../edu/harvard/data/identity/IdentityScrubber.html" title="class in edu.harvard.data.identity">IdentityScrubber</a>&lt;T&gt;</td>
<td class="colLast">
<div class="block">Base class for the identity scrub mapper job.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><a href="../../../../edu/harvard/data/identity/IdentityScrubHadoopJob.html" title="class in edu.harvard.data.identity">IdentityScrubHadoopJob</a></td>
<td class="colLast">&nbsp;</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><a href="../../../../edu/harvard/data/identity/LongIdentityMapper.html" title="class in edu.harvard.data.identity">LongIdentityMapper</a></td>
<td class="colLast">
<div class="block">Definition of a map job that operates over records with a <code>Long</code> typed
 main identifier.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><a href="../../../../edu/harvard/data/identity/LongIdentityReducer.html" title="class in edu.harvard.data.identity">LongIdentityReducer</a></td>
<td class="colLast">
<div class="block">Definition of the general (i.e.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><a href="../../../../edu/harvard/data/identity/StringIdentityMapper.html" title="class in edu.harvard.data.identity">StringIdentityMapper</a></td>
<td class="colLast">
<div class="block">Definition of a map job that operates over records with a <code>String</code>
 typed main identifier.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><a href="../../../../edu/harvard/data/identity/StringIdentityReducer.html" title="class in edu.harvard.data.identity">StringIdentityReducer</a></td>
<td class="colLast">
<div class="block">Definition of the general (i.e.</div>
</td>
</tr>
</tbody>
</table>
</li>
<li class="blockList">
<table class="typeSummary" border="0" cellpadding="3" cellspacing="0" summary="Enum Summary table, listing enums, and an explanation">
<caption><span>Enum Summary</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colFirst" scope="col">Enum</th>
<th class="colLast" scope="col">Description</th>
</tr>
<tbody>
<tr class="altColor">
<td class="colFirst"><a href="../../../../edu/harvard/data/identity/IdentifierType.html" title="enum in edu.harvard.data.identity">IdentifierType</a></td>
<td class="colLast">
<div class="block">Enumeration of the different identifiers that appear across the various data
 sets.</div>
</td>
</tr>
</tbody>
</table>
</li>
<li class="blockList">
<table class="typeSummary" border="0" cellpadding="3" cellspacing="0" summary="Exception Summary table, listing exceptions, and an explanation">
<caption><span>Exception Summary</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colFirst" scope="col">Exception</th>
<th class="colLast" scope="col">Description</th>
</tr>
<tbody>
<tr class="altColor">
<td class="colFirst"><a href="../../../../edu/harvard/data/identity/IdentityImplementationException.html" title="class in edu.harvard.data.identity">IdentityImplementationException</a></td>
<td class="colLast">
<div class="block">Exception thrown if some invariant under which a method should be called is
 violated.</div>
</td>
</tr>
</tbody>
</table>
</li>
</ul>
<a name="package.description">
<!--   -->
</a>
<h2 title="Package edu.harvard.data.identity Description">Package edu.harvard.data.identity Description</h2>
<div class="block">This package contains the majority of the code needed to manage user
 identities across data sets.
 <p>
 The basic premise behind identity management is that it is undesirable for
 researchers to automatically have access to semantically-meaningful
 identifiers for individuals in the data set. While we are not aiming to
 create a de-identified data set (at least not at this point in the data
 processing lifecycle), we aim to make it harder for researchers who have not
 gone through the appropriate authorization process to casually identify
 individuals.
 <p>
 On the other hand, for a data set to be useful for research, we must maintain
 some concept of identity. Within a single data set, we will often see some
 user identifier used as a key to link tables. For example, we may have a
 <code>users</code> table and an <code>events</code> table, where the
 <code>id</code> column in <code>users</code> is referenced in
 <code>events</code> as <code>user_id</code>. We need to preserve this
 relationship in order for the data set to be meaningful.
 <p>
 Additionally, we must maintain identity relationships between data sets. Just
 as user identifiers are necessary when joining tables within a data set, it
 is important that we be able to join disparate data sets that share a common
 user identifier, even though we do not want to reveal the true value of that
 identifier for any individual user.
 <p>
 A final requirement is that, although identities should be obscured in the
 general case, we must maintain the ability to re-identify users if necessary.
 The process by which a researcher is authorized to see real user identities
 is outside the scope of the system, but there are legitimate cases where a
 researcher may wish to join the data produced by this system with some
 external data source.
 <p>
 For a given data set, we require a JSON document that describes the tables
 and columns that contain user identifiers. See
 <code>IdentitySchemaTransformer</code> for a description of the JSON
 specification. We also require that each data set defines a
 <code>main identifier</code> value. This is an instance of the
 <code>IdentifierType</code> enum that represents the primary means of identifying
 a user in that data set. This is generally the primary key of the
 <code>user</code> table, or some similar identifier.
 <p>
 We define a single <code>research UUID</code> that represents a user across
 data sets. This ID is semantically-meaningless; it is a randomly-generated
 string that does not act as a key into any external system. However, it is
 guaranteed to be unique to the user it represents, and to consistently
 represent that user across data sets. The research UUID is the primary key of
 the <code>identity_map</code> database table, which allows us to reconstruct
 a user's identity if necessary. We assume that access to the
 <code>identity_map</code> table is closely guarded.
 <p>
 The basic approach is that we set aside a phase in the data processing
 pipeline (generally Phase 1) to handle identity. During this phase we perform
 two sets of map reduce jobs:
 <p>
 <b>Identity Job</b>. There is one identity job for a given data set. It uses
 one mapper per identifying table, and a single reducer. Each mapper produces
 a map from the main identifier type to a collection of
 <code>HadoopIdentityKey</code> values that contain all identifiers for that user
 found in the table. The job then runs a single reducer that gathers all
 <code>HadoopIdentityKey</code> values for a given main identifier and produces a
 single <code>IdentityMap</code> object for that user.
 <p>
 <b>Scrubber Job</b>. The scrubber jobs run after the identity job is
 complete. There is one scrubber job per identifying table, each of which
 contains one mapper and no reducer. The scrubber mapper takes the identity
 map generated in the identity job and processes every line of the input
 table. It sets the research UUID for any users that appear in the original
 row, and strips out any other identities.
 <p>
 In order to ensure that research UUIDs remain consistent between multiple
 data sets (and multiple processing runs of the same data set), we require
 that the current identity_map table be supplied as an input to the identity
 job. That way, if the identity reducer encounters a user for whom a research
 UUID has already been generated (this is the common case), it can re-use that
 ID rather than generating a new one. To avoid race conditions in updating the
 identity_map table, we require that only one data pipeline run its identity
 processing phase at a time, and that the updated identity_map be written back
 to the database before the next pipeline begins to process identities. Access
 to the identity_map is controlled by a lease in DynamoDB (see the
 <a href="../../../../edu/harvard/data/leases/package-summary.html"><code>edu.harvard.data.leases</code></a> package for details on leases).
 <p>
 It is recommended (although not requred) that the per-table mappers and
 scrubbers be generated. See
 <a href="../../../../edu/harvard/data/generator/IdentityMapperGenerator.html" title="class in edu.harvard.data.generator"><code>IdentityMapperGenerator</code></a> and
 <a href="../../../../edu/harvard/data/generator/IdentityScrubberGenerator.html" title="class in edu.harvard.data.generator"><code>IdentityScrubberGenerator</code></a> for generator
 code for these two sets of classes. To simplify any generated code, this
 package contains base implementations of both jobs that can be extended with
 minimal additional code. Because Hadoop requires that the types of keys and
 values be declared as part of a job's definition we have multiple base
 classes for the mappers and scrubbers, to be used depending on the type of
 the main identifier. See <code>LongIdentityMapper</code> and
 <code>IdentityScrubber</code> for examples.</div>
</div>
<!-- ======= START OF BOTTOM NAVBAR ====== -->
<div class="bottomNav"><a name="navbar.bottom">
<!--   -->
</a>
<div class="skipNav"><a href="#skip.navbar.bottom" title="Skip navigation links">Skip navigation links</a></div>
<a name="navbar.bottom.firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../../overview-summary.html">Overview</a></li>
<li class="navBarCell1Rev">Package</li>
<li>Class</li>
<li><a href="package-use.html">Use</a></li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../../index-all.html">Index</a></li>
<li><a href="../../../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList">
<li><a href="../../../../edu/harvard/data/generator/package-summary.html">Prev&nbsp;Package</a></li>
<li><a href="../../../../edu/harvard/data/io/package-summary.html">Next&nbsp;Package</a></li>
</ul>
<ul class="navList">
<li><a href="../../../../index.html?edu/harvard/data/identity/package-summary.html" target="_top">Frames</a></li>
<li><a href="package-summary.html" target="_top">No&nbsp;Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_bottom">
<li><a href="../../../../allclasses-noframe.html">All&nbsp;Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_bottom");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<a name="skip.navbar.bottom">
<!--   -->
</a></div>
<!-- ======== END OF BOTTOM NAVBAR ======= -->
<p class="legalCopy"><small>Copyright &#169; 2016. All rights reserved.</small></p>
</body>
</html>
